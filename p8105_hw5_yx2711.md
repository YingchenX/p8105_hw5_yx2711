p8105_hw5_yx2711
================
Yingchen Xu
2022-11-15

# Problem 1

Use the `list.files()` function to create the dataframe containing all
file names. Use the `map()` function to iterate file names, read in the
data, and save the result as `full_df`.

``` r
full_df = 
  tibble(
    files = list.files("hw5_data/data/"),
    path = str_c("hw5_data/data/", files)
  ) %>% 
  mutate(data = map(path, read_csv)) %>% 
  unnest()
```

Tidy the results using `mutate()` and `pivot_longer()`.

``` r
tidy_df = 
  full_df %>% 
  mutate(
    files = str_replace(files, ".csv", ""),
    group = str_sub(files, 1, 3)) %>% 
  pivot_longer(
    week_1:week_8,
    names_to = "week",
    values_to = "outcome",
    names_prefix = "week_") %>% 
  mutate(week = as.numeric(week)) %>% 
  select(group, subj = files, week, outcome)
```

Make a spaghetti plot showing each subject overtime.

``` r
tidy_df %>% 
  ggplot(aes(x = week, y = outcome, group = subj, color = group)) + 
  geom_point() + 
  geom_path() + 
  facet_grid(~group)
```

<img src="p8105_hw5_yx2711_files/figure-gfm/unnamed-chunk-3-1.png" width="90%" />

There is a within-subject correlation. Subjects in the control groups do
not have a specific trend in change overtime, while subjects in the
experimental group have a linear increase in general.

# Problem 2

``` r
homicide = read.csv("data/homicide-data.csv") %>% 
  janitor::clean_names() 
```

The raw dataset contain 52179 observations and 12 variables. The key
variables are uid, reported_date, victims’ names, race, age, sex, city,
state, longitude and latitude, and one disposition variable indicating
the arrest status of the victims. The raw dataset summarizes homicides
data in 28 states and 50 cities.

``` r
homicide = homicide %>% 
  mutate(
    city_state = str_c(city, ", ", state)
  )


summary = homicide %>% 
  group_by(city_state) %>% 
  summarize(
    total_number = n(),
    total_unsolved = sum(disposition == c("Closed without arrest", "Open/No arrest")
  ))

summary %>% knitr::kable()
```

| city_state         | total_number | total_unsolved |
|:-------------------|-------------:|---------------:|
| Albuquerque, NM    |          378 |             75 |
| Atlanta, GA        |          973 |            172 |
| Baltimore, MD      |         2827 |            906 |
| Baton Rouge, LA    |          424 |            102 |
| Birmingham, AL     |          800 |            192 |
| Boston, MA         |          614 |            154 |
| Buffalo, NY        |          521 |            157 |
| Charlotte, NC      |          687 |            101 |
| Chicago, IL        |         5535 |           2046 |
| Cincinnati, OH     |          694 |            151 |
| Columbus, OH       |         1084 |            308 |
| Dallas, TX         |         1567 |            381 |
| Denver, CO         |          312 |             82 |
| Detroit, MI        |         2519 |            739 |
| Durham, NC         |          276 |             51 |
| Fort Worth, TX     |          549 |            125 |
| Fresno, CA         |          487 |             88 |
| Houston, TX        |         2942 |            705 |
| Indianapolis, IN   |         1322 |            309 |
| Jacksonville, FL   |         1168 |            305 |
| Kansas City, MO    |         1190 |            251 |
| Las Vegas, NV      |         1381 |            274 |
| Long Beach, CA     |          378 |             81 |
| Los Angeles, CA    |         2257 |            551 |
| Louisville, KY     |          576 |            139 |
| Memphis, TN        |         1514 |            259 |
| Miami, FL          |          744 |            225 |
| Milwaukee, wI      |         1115 |            197 |
| Minneapolis, MN    |          366 |             89 |
| Nashville, TN      |          767 |            130 |
| New Orleans, LA    |         1434 |            479 |
| New York, NY       |          627 |            102 |
| Oakland, CA        |          947 |            255 |
| Oklahoma City, OK  |          672 |            158 |
| Omaha, NE          |          409 |             80 |
| Philadelphia, PA   |         3037 |            684 |
| Phoenix, AZ        |          914 |            250 |
| Pittsburgh, PA     |          631 |            169 |
| Richmond, VA       |          429 |             53 |
| Sacramento, CA     |          376 |             71 |
| San Antonio, TX    |          833 |            178 |
| San Bernardino, CA |          275 |             82 |
| San Diego, CA      |          461 |             81 |
| San Francisco, CA  |          663 |            166 |
| Savannah, GA       |          246 |             50 |
| St. Louis, MO      |         1677 |            449 |
| Stockton, CA       |          444 |            136 |
| Tampa, FL          |          208 |             56 |
| Tulsa, AL          |            1 |              0 |
| Tulsa, OK          |          583 |             83 |
| Washington, DC     |         1345 |            306 |

The above table summarizes within cities the total number of homicides
indicating by `total_number` and the number of unsolved homicides
indicating by `total_unsolved`.

Use `prop.test()` function to estimate the proportion of unsolved
homicides in Baltimore, MD.

``` r
baltimore_test = prop.test(
    summary %>% filter(city_state == "Baltimore, MD") %>% pull(total_unsolved),
    summary %>% filter(city_state == "Baltimore, MD") %>% pull(total_number)
    ) %>% 
  broom::tidy()

baltimore_test %>% 
  select(estimate, conf.low, conf.high) %>% 
  knitr::kable(digits = 3)
```

| estimate | conf.low | conf.high |
|---------:|---------:|----------:|
|     0.32 |    0.303 |     0.338 |

The estimate of proportion of homicides that are unsolved in Baltimore
is 0.3204811 (95% CI: 0.3033582 to 0.3380962).
